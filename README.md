# Kiloverb

A mono reverb algorithm for the Spin Semiconductor FV-1 DSP chip, designed for DIY reverb pedal projects.

This implementation uses a series Feedback Delay Network (FDN) architecture to achieve high echo density within the FV-1's constraints (128 instructions per sample and 32K samples of delay memory). The algorithm includes both plate-style and room-style reverbs with adjustable density and pre-delay options.

The FV-1 is a specialized DSP chip commonly used in guitar pedals and eurorack modules. This repository provides everything needed to program the chip with these reverb algorithms.

### Usage

**Binary (.hex)** - `build/` directory
The eight programs compiled into a single hex file bank, ready to program directly to an EEPROM.

**Assembly (.asm)** - `asm/` directory
Source code in Spin ASM assembly format. If you have access to the Spin compiler, you can modify and rebuild.

**Python codegen notebook (.ipynb)** - Also available on [Colab](https://colab.research.google.com/drive/1UXEQfW70_h95IFX2UWLO2TrLBk4rvuaG).
Most of the assembly is generated by Python code that calculates delay times, generates random numbers for diffusion, and templates the repetitive matrix computations. This is the easiest way to make meaningful changes to the algorithm.

Each time you run the notebook, new random numbers are generated for the diffusion network, making each build unique.

### The Eight Programs

The bank contains eight programs covering different reverb characteristics:

**Variations:**
- **Algorithm**: Plate or Room
  - *Plate*: Dense from the start, no sense of natural space, smooth exponential decay
  - *Room*: Distinct early reflections with gradual density buildup, sounds like an acoustic space
- **Density**: Sparse or Dense
  - *Sparse*: More open, individual echoes may be audible
  - *Dense*: Maximum diffusion, smooth wash
- **Pre-delay**: Short or Long
  - *Short*: Immediate reverb response
  - *Long*: Delayed reverb onset for separation between dry and wet signals

**Program List:**
| Program | Algorithm | Density | Pre-delay |
|---------|-----------|---------|-----------|
| 0 | Plate | Sparse | Short |
| 1 | Plate | Sparse | Long |
| 2 | Plate | Dense | Short |
| 3 | Plate | Dense | Long |
| 4 | Room | Sparse | Short |
| 5 | Room | Sparse | Long |
| 6 | Room | Dense | Short |
| 7 | Room | Dense | Long |

**Controls:**
- Pot 0: Reverb decay time
- Pot 1: No connection
- Pot 2: No connection


### How It Works

The [THEORY_OF_OPERATION.md](THEORY_OF_OPERATION.md) file describes the algorithm architecture, including:
- Why series FDN structures are more efficient than single large FDNs
- The scattering technique that effectively doubles the structure size for free on the FV-1
- How delay time selection shapes the character (plate vs room)
- The design decisions behind achieving high echo density within the FV-1's limitations
